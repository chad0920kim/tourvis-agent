<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>투어비스 고객센터 에이전트 대시보드</title>
    <link rel="icon" href="data:,">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> 투어비스 고객센터 에이전트 대시보드</h1>
            <div class="connection-status disconnected" id="connectionStatus">
                <span id="connectionText">API 연결 확인 중...</span>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" id="feedbackTab" onclick="switchTab('feedback')">
                <i class="fas fa-chart-bar"></i> 피드백 분석
            </button>
            <button class="tab-button" id="conversationsTab" onclick="switchTab('conversations')">
                <i class="fas fa-comments"></i> Q&A 분석
            </button>
        </div>

        <!-- 피드백 분석 탭 -->
        <div class="tab-content active" id="feedbackContent">
            <div class="controls">
                <div class="controls-row">
                    <div class="control-group">
                        <label for="daysSelect">📅 기간:</label>
                        <select id="daysSelect">
                            <option value="1">오늘</option>
                            <option value="3">3일</option>
                            <option value="7" selected>7일</option>
                            <option value="14">14일</option>
                            <option value="30">30일</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="limitSelect">📋 표시 개수:</label>
                        <select id="limitSelect">
                            <option value="10">10개</option>
                            <option value="20">20개</option>
                            <option value="50" selected>50개</option>
                            <option value="100">100개</option>
                        </select>
                    </div>
                    <button class="refresh-btn" onclick="refreshData()">🔄 새로고침</button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value positive" id="totalFeedback">0</div>
                    <div class="stat-label">📝 총 피드백</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value info" id="totalQA">0</div>
                    <div class="stat-label">💬 총 Q&A</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value warning" id="responseRate">0%</div>
                    <div class="stat-label">📈 피드백 응답률</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value positive" id="positiveFeedback">0</div>
                    <div class="stat-label">👍 도움됨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value negative" id="negativeFeedback">0</div>
                    <div class="stat-label">👎 아쉬움</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value info" id="satisfactionRate">0%</div>
                    <div class="stat-label">😊 만족도</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value secondary" id="uniqueUsers">0</div>
                    <div class="stat-label">👥 순 사용자</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value warning" id="participationRate">0회</div>
                    <div class="stat-label">🎯 사용자당 평균</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">📈 시간별 피드백 추이</h3>
                    <div class="chart-wrapper">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">🥧 피드백 분포</h3>
                    <div class="chart-wrapper">
                        <canvas id="avgChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">📊 피드백 응답률 추이</h3>
                    <div class="chart-wrapper">
                        <canvas id="responseRateChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="data-section">
                <div class="section-header">
                    <h3 class="section-title">📋 최근 피드백 상세</h3>
                    <span class="data-count" id="feedbackCount">0개</span>
                </div>

                <div class="data-filters">
                    <button class="active" id="allBtn" onclick="loadFeedback('all')">전체</button>
                    <button id="positiveBtn" onclick="loadFeedback('positive')">👍 도움됨</button>
                    <button id="negativeBtn" onclick="loadFeedback('negative')">👎 아쉬움</button>
                </div>

                <div class="expand-controls">
                    <button onclick="expandAllAnswers()">📖 모든 답변 펼치기</button>
                    <button onclick="collapseAllAnswers()">📕 모든 답변 접기</button>
                </div>

                <div id="feedbackList">
                    <div class="loading">피드백 데이터를 불러오는 중...</div>
                </div>
            </div>
        </div>

        <!-- Q&A 분석 탭 -->
        <div class="tab-content" id="conversationsContent">
            <div class="controls">
                <div class="controls-row">
                    <div class="control-group">
                        <label for="conversationDaysSelect"><i class="fas fa-calendar"></i> 기간:</label>
                        <select id="conversationDaysSelect">
                            <option value="1">오늘</option>
                            <option value="3">3일</option>
                            <option value="7" selected>7일</option>
                            <option value="14">14일</option>
                            <option value="30">30일</option>
                        </select>
                    </div>
                    <button class="refresh-btn" onclick="refreshConversationData()">
                        <i class="fas fa-sync-alt"></i> 새로고침
                    </button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value info" id="totalConversations">0</div>
                    <div class="stat-label"><i class="fas fa-users"></i> 총 사용자</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value positive" id="matchGood">0</div>
                    <div class="stat-label"><i class="fas fa-check-circle"></i> 매치</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value negative" id="matchBad">0</div>
                    <div class="stat-label"><i class="fas fa-times-circle"></i> 매치 안됨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value warning" id="matchImprove">0</div>
                    <div class="stat-label"><i class="fas fa-arrow-up"></i> 보강 필요</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value secondary" id="matchNone">0</div>
                    <div class="stat-label"><i class="fas fa-question-circle"></i> 미평가</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title"><i class="fas fa-bullseye"></i> 매치 상태 분포</h3>
                    <div class="chart-wrapper">
                        <canvas id="matchStatusChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title"><i class="fas fa-clock"></i> Q&A 시간별 추이</h3>
                    <div class="chart-wrapper">
                        <canvas id="qaTimeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="dashboard.js"></script>
</body>
</html>
